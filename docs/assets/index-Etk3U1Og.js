var A=Object.defineProperty;var S=(o,t,e)=>t in o?A(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>(S(o,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();class a{constructor(t,e){l(this,"x");l(this,"y");this.x=t,this.y=e}plus(t){return new a(this.x+t.x,this.y+t.y)}times(t){return new a(this.x*t,this.y*t)}static create(t,e){return new a(t,e)}}function M(o,t){return o.pos.x+o.size.x>t.pos.x&&o.pos.x<t.pos.x+t.size.x&&o.pos.y+o.size.y>t.pos.y&&o.pos.y<t.pos.y+t.size.y}class y{constructor(t,e,s){l(this,"level");l(this,"actors");l(this,"status");this.level=t,this.actors=e,this.status=s}get player(){return this.actors.find(t=>t.type=="player")}update(t,e){let s=this.actors.map(n=>n.update(t,this,e)),r=new y(this.level,s,this.status);if(r.status!="playing")return r;let i=r.player;if(this.level.touches(i.pos,i.size,"lava"))return new y(this.level,s,"lost");for(let n of s)n!=i&&M(n,i)&&(r=n.collide(r));return r}static start(t){return new y(t,t.startActors,"playing")}}const v={scale:20,actors:{coin:{wobbleSpeed:8,wobbleDist:.07,size:{x:.6,y:.6}},lava:{size:{x:1,y:1}},player:{playerXSpeed:7,gravity:30,jumpSpeed:17,size:{x:.8,y:1.5}}}},{actors:{coin:g}}=v;let E=class{constructor(){l(this,"type","coin");l(this,"size",a.create(g.size.x,g.size.y))}};class x extends E{constructor(e,s,r){super();l(this,"pos");l(this,"basePos");l(this,"wobble");this.pos=e,this.basePos=s,this.wobble=r}collide(e){let s=e.actors.filter(i=>i!=this),r=e.status;return s.some(i=>i.type=="coin")||(r="won"),new y(e.level,s,r)}update(e){let s=this.wobble+e*g.wobbleSpeed,r=Math.sin(s)*g.wobbleDist;return new x(this.basePos.plus(a.create(0,r)),this.basePos,s)}static create(e){let s=e.plus(a.create(.2,.1));return new x(s,s,Math.random()*Math.PI*2)}}const{actors:{lava:P}}=v;let O=class{constructor(){l(this,"size",a.create(P.size.x,P.size.y));l(this,"type","lava")}};class p extends O{constructor(e,s,r){super();l(this,"pos");l(this,"speed");l(this,"reset");this.pos=e,this.speed=s,this.reset=r}collide(e){return new y(e.level,e.actors,"lost")}update(e,s){let r=this.pos.plus(this.speed.times(e));return s.level.touches(r,this.size,"wall")?this.reset?new p(this.reset,this.speed,this.reset):new p(this.pos,this.speed.times(-1)):new p(r,this.speed,this.reset)}static create(e,s){return s=="="?new p(e,a.create(2,0)):s=="|"?new p(e,a.create(0,2)):s=="v"?new p(e,a.create(0,3),e):new p(e,a.create(0,3),e)}}const{actors:{player:w}}=v;class ${constructor(){l(this,"type","player");l(this,"size",a.create(w.size.x,w.size.y))}}class b extends ${constructor(e,s){super();l(this,"pos");l(this,"speed");this.pos=e,this.speed=s}collide(e){return e}update(e,s,r){let i=0;r.left&&(i-=w.playerXSpeed),r.right&&(i+=w.playerXSpeed);let n=this.pos,d=n.plus(a.create(i*e,0));s.level.touches(d,this.size,"wall")||(n=d);let c=this.speed.y+e*w.gravity,u=n.plus(a.create(0,c*e));return s.level.touches(u,this.size,"wall")?r.up&&c>0?c=-w.jumpSpeed:c=0:n=u,new b(n,a.create(i,c))}static create(e){return new b(e.plus(a.create(0,-.5)),a.create(0,0))}}function N(o){switch(o){case"o":return x;case"@":return b;default:return p}}class z{constructor(t){l(this,"height");l(this,"width");l(this,"startActors");l(this,"rows");let e=t.trim().split(`
`).map(s=>[...s]);this.height=e.length,this.width=e[0].length,this.startActors=[],this.rows=e.map((s,r)=>s.map((i,n)=>["#","+","."].includes(i)?{"#":"wall","+":"lava",".":"empty"}[i]:(this.startActors.push(N(i).create(a.create(n,r),i)),"empty")))}touches(t,e,s){let r=Math.floor(t.x),i=Math.ceil(t.x+e.x),n=Math.floor(t.y),d=Math.ceil(t.y+e.y);for(let c=n;c<d;c++)for(let u=r;u<i;u++)if((u<0||u>=this.width||c<0||c>=this.height?"wall":this.rows[c][u])==s)return!0;return!1}static create(t){return new z(t)}}const C=[`
......................
..#................#..
..#..............=.#..
..#.........o.o....#..
..#.@......#####...#..
..#####............#..
......#++++++++++++#..
......##############..
......................
`,`                                                    
................................................................................
................................................................................
................................................................................
................................................................................
................................................................................
................................................................................
..................................................................###...........
...................................................##......##....##+##..........
....................................o.o......##..................#+++#..........
.................................................................##+##..........
...................................#####..........................#v#...........
............................................................................##..
..##......................................o.o................................#..
..#.....................o....................................................#..
..#......................................#####.............................o.#..
..#..........####.......o....................................................#..
..#..@.......#..#................................................#####.......#..
..############..###############...####################.....#######...#########..
..............................#...#..................#.....#....................
..............................#+++#..................#+++++#....................
..............................#+++#..................#+++++#....................
..............................#####..................#######....................
................................................................................
................................................................................
`,`                                                                     
................................................................................
................................................................................
....###############################.............................................
...##.............................##########################################....
...#.......................................................................##...
...#....o...................................................................#...
...#................................................=.......................#...
...#.o........################...................o..o...........|........o..#...
...#.........................#..............................................#...
...#....o....................##########.....###################....##########...
...#..................................#+++++#.................#....#............
...###############....oo......=o.o.o..#######.###############.#....#............
.....#...............o..o.............#.......#......#........#....#............
.....#....................#############..######.####.#.########....########.....
.....#.............########..............#...........#.#..................#.....
.....#..........####......####...#####################.#..................#.....
.....#........###............###.......................########....########.....
.....#.......##................#########################......#....#............
.....#.......#................................................#....#............
.....###......................................................#....#............
.......#...............o...........................................#............
.......#...............................................o...........#............
.......#########......###.....############.........................##...........
.............#..................#........#####....#######.o.........########....
.............#++++++++++++++++++#............#....#.....#..................#....
.............#++++++++++++++++++#..........###....###...####.o.............#....
.............####################..........#........#......#.....|.........#....
...........................................#++++++++#......####............#....
...........................................#++++++++#.........#........@...#....
...........................................#++++++++#.........##############....
...........................................##########...........................
................................................................................
`,`
......................................#++#........................#######....................................#+#..
......................................#++#.....................####.....####.................................#+#..
......................................#++##########...........##...........##................................#+#..
......................................##++++++++++##.........##.............##...............................#+#..
.......................................##########++#.........#....................................o...o...o..#+#..
................................................##+#.........#.....o...o....................................##+#..
.................................................#+#.........#................................###############++#..
.................................................#v#.........#.....#...#........................++++++++++++++##..
.............................................................##..|...|...|..##............#####################...
..............................................................##+++++++++++##............v........................
...............................................................####+++++####......................................
...............................................#.....#............#######........###.........###..................
...............................................#.....#...........................#.#.........#.#..................
...............................................#.....#.............................#.........#....................
...............................................#.....#.............................##........#....................
...............................................##....#.............................#.........#....................
...............................................#.....#......o..o.....#...#.........#.........#....................
...............#######........###...###........#.....#...............#...#.........#.........#....................
..............##.....##.........#...#..........#.....#.....######....#...#...#########.......#....................
.............##.......##........#.o.#..........#....##...............#...#...#...............#....................
.....@.......#.........#........#...#..........#.....#...............#...#...#...............#....................
....###......#.........#........#...#..........#.....#...............#...#####...######......#....................
....#.#......#.........#.......##.o.##.........#.....#...............#.....o.....#.#.........#....................
++++#.#++++++#.........#++++++##.....##++++++++##....#++++++++++.....#.....=.....#.#.........#....................
++++#.#++++++#.........#+++++##.......##########.....#+++++++##+.....#############.##..o.o..##....................
++++#.#++++++#.........#+++++#....o.................##++++++##.+....................##.....##.....................
++++#.#++++++#.........#+++++#.....................##++++++##..+.....................#######......................
++++#.#++++++#.........#+++++##.......##############++++++##...+..................................................
++++#.#++++++#.........#++++++#########++++++++++++++++++##....+..................................................
++++#.#++++++#.........#++++++++++++++++++++++++++++++++##.....+..................................................
`,`
..............................................................................................................
..............................................................................................................
..............................................................................................................
..............................................................................................................
..............................................................................................................
........................................o.....................................................................
..............................................................................................................
........................................#.....................................................................
........................................#.....................................................................
........................................#.....................................................................
........................................#.....................................................................
.......................................###....................................................................
.......................................#.#.................+++........+++..###................................
.......................................#.#.................+#+........+#+.....................................
.....................................###.###................#..........#......................................
......................................#...#.................#...oooo...#.......###............................
......................................#...#.................#..........#......#+++#...........................
......................................#...#.................############.......###............................
.....................................##...##......#...#......#................................................
......................................#...#########...########..............#.#...............................
......................................#...#...........#....................#+++#..............................
......................................#...#...........#.....................###...............................
.....................................##...##..........#.......................................................
......................................#...#=.=.=.=....#............###........................................
......................................#...#...........#...........#+++#.......................................
......................................#...#....=.=.=.=#.....o......###.......###..............................
.....................................##...##..........#.....................#+++#.............................
..............................o...o...#...#...........#.....#................##v........###...................
......................................#...#...........#..............#.................#+++#..................
.............................###.###.###.###.....o.o..#++++++++++++++#...................v#...................
.............................#.###.#.#.###.#..........#++++++++++++++#........................................
.............................#.............#...#######################........................................
.............................##...........##.........................................###......................
..###.........................#.....#.....#.........................................#+++#................###..
..#.#.........................#....###....#..........................................###.................#.#..
..#...........................#....###....#######........................#####.............................#..
..#...........................#...........#..............................#...#.............................#..
..#...........................##..........#..............................#.#.#.............................#..
..#.......................................#.......|####|....|####|.....###.###.............................#..
..#................###.............o.o....#..............................#.........###.....................#..
..#...............#####.......##..........#.............................###.......#+++#..........#.........#..
..#...............o###o.......#....###....#.............................#.#........###..........###........#..
..#................###........#############..#.oo.#....#.oo.#....#.oo..##.##....................###........#..
..#......@..........#.........#...........#++#....#++++#....#++++#....##...##....................#.........#..
..#############################...........#############################.....################################..
..............................................................................................................
..............................................................................................................
`,`
..................................................................................................###.#.......
......................................................................................................#.......
..................................................................................................#####.......
..................................................................................................#...........
..................................................................................................#.###.......
..........................o.......................................................................#.#.#.......
.............................................................................................o.o.o###.#.......
...................###................................................................................#.......
.......+..o..+................................................#####.#####.#####.#####.#####.#####.#####.......
.......#.....#................................................#...#.#...#.#...#.#...#.#...#.#...#.#...........
.......#=.o..#............#...................................###.#.###.#.###.#.###.#.###.#.###.#.#####.......
.......#.....#..................................................#.#...#.#...#.#...#.#...#.#...#.#.....#.......
.......+..o..+............o..................................####.#####.#####.#####.#####.#####.#######.......
..............................................................................................................
..........o..............###..............................##..................................................
..............................................................................................................
..............................................................................................................
......................................................##......................................................
...................###.........###............................................................................
..............................................................................................................
..........................o.....................................................#......#......................
..........................................................##.....##...........................................
.............###.........###.........###.................................#..................#.................
..............................................................................................................
.................................................................||...........................................
..###########.................................................................................................
..#.........#.o.#########.o.#########.o.##................................................#...................
..#.........#...#.......#...#.......#...#.................||..................#.....#.........................
..#..@......#####...o...#####...o...#####.....................................................................
..#######.....................................#####.......##.....##.....###...................................
........#=..................=................=#...#.....................###...................................
........#######################################...#+++++++++++++++++++++###+++++++++++++++++++++++++++++++++++
..................................................############################################################
..............................................................................................................
`],{scale:f}=v;function m(o,t,...e){let s=document.createElement(o);for(let r of Object.keys(t))s.setAttribute(r,t[r]);for(let r of e)s.appendChild(r);return s}function B(o){return m("table",{class:"background",style:`width: ${o.width*f}px`},...o.rows.map(t=>m("tr",{style:`height: ${f}px`},...t.map(e=>m("td",{class:e})))))}function D(o){return m("div",{},...o.map(t=>{let e=m("div",{class:`actor ${t.type}`});return e.style.width=`${t.size.x*f}px`,e.style.height=`${t.size.y*f}px`,e.style.left=`${t.pos.x*f}px`,e.style.top=`${t.pos.y*f}px`,e}))}class L{constructor(t,e){l(this,"dom");l(this,"actorLayer");this.dom=m("div",{class:"game"},B(e)),this.actorLayer=null,t.appendChild(this.dom)}clear(){this.dom.remove()}scrollPlayerIntoView(t){let e=this.dom.clientWidth,s=this.dom.clientHeight,r=e/3,i=this.dom.scrollLeft,n=i+e,d=this.dom.scrollTop,c=d+s,u=t.player,h=u.pos.plus(u.size.times(.5)).times(f);h.x<i+r?this.dom.scrollLeft=h.x-r:h.x>n-r&&(this.dom.scrollLeft=h.x+r-e),h.y<d+r?this.dom.scrollTop=h.y-r:h.y>c-r&&(this.dom.scrollTop=h.y+r-s)}syncState(t){this.actorLayer&&this.actorLayer.remove(),this.actorLayer=D(t.actors),this.dom.appendChild(this.actorLayer),this.dom.className=`game ${t.status}`,this.scrollPlayerIntoView(t)}}function T(o){return["ArrowLeft","k"].includes(o)?"left":["ArrowRight","ñ"].includes(o)?"right":"up"}function j(o){let t=Object.create(null);function e(s){o.includes(s.key)&&(t[T(s.key)]=s.type=="keydown",s.preventDefault())}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),t}const I=j(["ArrowLeft","ArrowRight","ArrowUp","k","o","ñ"]);function K(o){return new URLSearchParams(window.location.search).get(o)}function X(o,t){return isNaN(o)||o>t||o<0?(alert("Level does not exist"),0):o}function k(o){let t=null;function e(s){if(t!=null){let r=Math.min(s-t,100)/1e3;if(o(r)===!1)return}t=s,requestAnimationFrame(e)}requestAnimationFrame(e)}function q(o,t=L){let e=new t(document.body,o),s=y.start(o),r=1;return new Promise(i=>{k(n=>(s=s.update(n,I),e.syncState(s),s.status=="playing"?!0:r>0?(r-=n,!0):(e.clear(),i(s.status),!1)))})}async function F(o,t=L){const e=X(Number(K("level")),o.length-1);for(let s=e;s<o.length;)await q(z.create(o[s]),t)=="won"&&s++;console.log("You've won!")}F(C,L);
